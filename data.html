<!doctype html>

<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simpan Data - Nama & Password (LocalStorage)</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#9aa4b2;--danger:#ef4444}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#071426 0%, #0b1630 100%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:100%;max-width:920px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    header h1{font-size:20px;margin:0}
    .grid{display:grid;grid-template-columns:360px 1fr;gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text], input[type=password] {width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:inherit}
    .row{display:flex;gap:8px;align-items:center}
    button{background:var(--accent);border:none;color:#032027;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);font-weight:600}
    .small{padding:8px 10px;font-size:13px}
    .list{max-height:60vh;overflow:auto;padding:8px;border-radius:8px;margin-top:8px}
    .item{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);margin-bottom:8px}
    .meta{display:flex;gap:12px;align-items:center}
    .pill{font-size:12px;padding:6px 8px;border-radius:999px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
    .controls{display:flex;gap:8px}
    .muted{color:var(--muted);font-size:13px}
    footer{margin-top:12px;display:flex;gap:8px}
    .danger{background:var(--danger);color:white}
    .note{font-size:13px;color:var(--muted);margin-top:8px}
    @media (max-width:820px){.grid{grid-template-columns:1fr;}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Simpan Data — Nama & Password</h1>
      <div class="muted">Simpan di <strong>localStorage</strong> (tidak dikirim ke server)</div>
    </header><div class="grid">
  <div class="card">
    <form id="form">
      <div>
        <label for="name">Nama</label>
        <input id="name" type="text" placeholder="Masukkan nama" required />
      </div>
      <div style="margin-top:10px">
        <label for="password">Password</label>
        <div class="row">
          <input id="password" type="password" placeholder="Masukkan password" required />
          <button id="toggleView" class="ghost small" type="button">Lihat</button>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
        <button id="saveBtn" type="submit">Simpan</button>
        <button id="clearInputs" type="button" class="ghost small">Bersihkan</button>
        <div style="margin-left:auto" class="muted">Data tersimpan di key: <strong>users</strong></div>
      </div>
    </form>

    <div class="note">Tip: password disimpan apa adanya di localStorage. Jangan simpan data sensitif di browser kalau ingin aman.</div>
  </div>

  <div class="card">
    <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px">
      <input id="search" type="text" placeholder="Cari nama..." />
      <button id="refresh" class="ghost small">Segarkan</button>
      <button id="export" class="ghost small">Export JSON</button>
      <button id="importBtn" class="ghost small">Import JSON</button>
    </div>

    <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
      <label class="pill"><input id="showPasswords" type="checkbox" /> Tampilkan password di daftar</label>
      <label class="pill"><input id="maskPasswords" type="checkbox" checked /> Sembunyikan sebagian (••••)</label>
    </div>

    <div class="list" id="list"></div>

    <footer>
      <button id="deleteAll" class="danger small">Hapus Semua Data</button>
      <button id="downloadAll" class="ghost small">Download .json</button>
    </footer>
  </div>
</div>

  </div>  <script>
    const LS_KEY = 'users'
    const $ = id => document.getElementById(id)

    function loadUsers(){
      try{
        const raw = localStorage.getItem(LS_KEY)
        return raw ? JSON.parse(raw) : []
      }catch(e){
        console.error('Gagal parse localStorage', e)
        return []
      }
    }

    function saveUsers(users){
      localStorage.setItem(LS_KEY, JSON.stringify(users))
    }

    function addUser(name, password){
      const users = loadUsers()
      users.push({name: name.trim(), password: password})
      saveUsers(users)
      renderList()
    }

    function deleteUser(index){
      const users = loadUsers()
      if(index < 0 || index >= users.length) return
      users.splice(index,1)
      saveUsers(users)
      renderList()
    }

    function deleteAll(){
      if(!confirm('Hapus semua data? Tindakan ini tidak dapat dibatalkan.')) return
      localStorage.removeItem(LS_KEY)
      renderList()
    }

    function downloadJSON(){
      const data = loadUsers()
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'})
      const url = URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url; a.download = 'users.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url)
    }

    function exportToClipboard(){
      const data = JSON.stringify(loadUsers(), null, 2)
      navigator.clipboard?.writeText(data).then(()=>alert('JSON disalin ke clipboard'))
    }

    function importJSON(){
      const txt = prompt('Tempel JSON yang valid untuk di-import (akan menimpa data yang ada).')
      if(!txt) return
      try{
        const parsed = JSON.parse(txt)
        if(!Array.isArray(parsed)) throw new Error('Format harus array')
        localStorage.setItem(LS_KEY, JSON.stringify(parsed))
        renderList()
        alert('Import berhasil')
      }catch(err){
        alert('Import gagal: ' + err.message)
      }
    }

    function renderList(){
      const listEl = $('list')
      const query = $('search').value.toLowerCase().trim()
      const users = loadUsers()
      listEl.innerHTML = ''

      if(users.length === 0){
        listEl.innerHTML = '<div class="muted">(Belum ada data)</div>'
        return
      }

      users.forEach((u,i)=>{
        if(query && !u.name.toLowerCase().includes(query)) return
        const item = document.createElement('div')
        item.className = 'item'

        const left = document.createElement('div')
        left.className = 'meta'
        const name = document.createElement('div')
        name.innerHTML = '<strong>'+escapeHtml(u.name)+'</strong>'

        const pass = document.createElement('div')
        pass.className = 'muted'
        const show = $('showPasswords').checked
        const mask = $('maskPasswords').checked
        if(show){
          pass.textContent = u.password
        }else if(mask){
          pass.textContent = '•••• ' + u.password.slice(-2)
        }else{
          pass.textContent = '•••••••'
        }

        left.appendChild(name)
        left.appendChild(pass)

        const controls = document.createElement('div')
        controls.className = 'controls'
        const btnDel = document.createElement('button')
        btnDel.className = 'ghost small'
        btnDel.textContent = 'Hapus'
        btnDel.onclick = ()=>{
          if(confirm('Hapus data: '+u.name+' ?')) deleteUser(i)
        }

        const btnCopy = document.createElement('button')
        btnCopy.className = 'ghost small'
        btnCopy.textContent = 'Salin';
        btnCopy.onclick = ()=>{
          navigator.clipboard?.writeText(JSON.stringify(u)).then(()=>alert('Tersalin: '+u.name))
        }

        controls.appendChild(btnCopy)
        controls.appendChild(btnDel)

        item.appendChild(left)
        item.appendChild(controls)
        listEl.appendChild(item)
      })

      if(listEl.children.length === 0){
        listEl.innerHTML = '<div class="muted">(Tidak ada hasil pencarian)</div>'
      }
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>\"']/g, function(c){
        return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]
      })
    }

    // --- Event wiring
    document.addEventListener('DOMContentLoaded', ()=>{
      renderList()

      $('form').addEventListener('submit', e =>{
        e.preventDefault()
        const name = $('name').value
        const pw = $('password').value
        if(!name.trim() || !pw){ alert('Nama dan password wajib diisi'); return }
        addUser(name, pw)
        $('name').value = ''
        $('password').value = ''
      })

      $('toggleView').addEventListener('click', ()=>{
        const pw = $('password')
        if(pw.type === 'password') { pw.type = 'text'; $('toggleView').textContent = 'Sembunyikan' }
        else { pw.type = 'password'; $('toggleView').textContent = 'Lihat' }
      })

      $('clearInputs').addEventListener('click', ()=>{
        $('name').value = ''
        $('password').value = ''
      })

      $('search').addEventListener('input', renderList)
      $('refresh').addEventListener('click', renderList)
      $('showPasswords').addEventListener('change', renderList)
      $('maskPasswords').addEventListener('change', renderList)
      $('deleteAll').addEventListener('click', deleteAll)
      $('downloadAll').addEventListener('click', downloadJSON)
      $('export').addEventListener('click', exportToClipboard)
      $('importBtn').addEventListener('click', importJSON)
      $('export').addEventListener('contextmenu', e=>{e.preventDefault(); downloadJSON()})

      $('downloadAll').addEventListener('click', ()=>{
        if(loadUsers().length === 0){ alert('Tidak ada data untuk di-download'); return }
        downloadJSON()
      })

    })
  </script></body>
</html>
